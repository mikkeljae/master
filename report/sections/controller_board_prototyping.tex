%!TEX root = ../main.tex
\subsection{Prototyping}
\label{sub:controller_board_prototyping}
Something clever about why we made prototypes.


\subsubsection{Testing the Power Board}
It was decided to test the power board before ordering it from a professional PCB manufacturer.
In order to test it a home-made PCB was made at the University's PCB lab.

Three main functionalities should be verified on the board:

\begin{itemize}
	\item Schmitt-trigger circuitry and \texttt{AND} gate circuit
	\item PWM logic level shifting and phase shifting
	\item Motor driver circuit
\end{itemize}

The remaining functionalities has either been tested beforehand or deemed too simple to test. 

\par{Schmitt-trigger Circuitry and \texttt{AND} Gate Circuit}
The circuit can bee seen in.... \mikkel{Make a figure somewhere}.
The Schmitt-triggers were tested by varying the input voltage and verifying the switching threshold along with the the hysteresis levels. 
Testing the \texttt{AND} gate was done by applying different logic levels and verifying the results.
The complete circuit was found to work as intended.

\par{PWM Logic Level Shifting and Phase Shifting}
The circuit can bee seen in.... \mikkel{Make a figure somewhere}.
The functionality of the logic level shifter \texttt{74LVC2G17} was verified by measuring input and output on an oscilloscope. 
The output of the \texttt{NOT} gate was not as expected as it was noise with a DC offset. 
The reason behind the problem was not found, but most probably it was a production error as the schematic showed no problems.
While investigating the schematic it was found that the gate is not needed as the high side signals to the motor driver can be replaced by \texttt{high} signals, because the driver has a shoot-through protection scheme.
Therefore the \texttt{NOT} will be omitted in the next version of the board.

\par{Motor Driver Circuit}
The motor driver receives signals from the not functioning \texttt{NOT} gate and could therefore not easily be tested on the produces board.
Therefore it was decided to develop a small test PCB with the only purpose of testing the motor driver circuit.
The circuit can bee seen in.... \mikkel{Make a figure somewhere}.
The board was connected to four MOSFETs, a resistor as a load and PWM signals on the inputs. 
Measuring the gate signals showed strange behaviour and after a thorough inspection of the board and the schematic it was found that the bootstrap diode was facing the wrong direction. 
The reason behind was an error in the footprint. 
After correcting the error the functions of the driver and the bootstrap circuit was verified. 
The measured signals are shown in figure \ref{fig:test_hip_signals}.
\mikkel{More elaboration is needed}
\mikkel{FIGURE HERE!}
%\begin{figure}[h]
%	\centering
%    \input{graphics/test_motor_drive_signals.tex}
%	\caption{. }
%	\label{fig:test_hip_signals}
%\end{figure}